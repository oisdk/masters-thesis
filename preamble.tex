\documentclass[acmsmall,screen]{acmart}

\definecolor{AHKeywordColour}    {cmyk}{0.86,0.91,0,0.04}
\definecolor{AHFunctionColour}   {cmyk}{0.64,0,0.95,0.40}
\definecolor{AHConstructorColour}{cmyk}{0,0.83,1,0.70}
\definecolor{AHNumberColour}     {HTML}{A020F0}
\definecolor{AHStringColour}     {HTML}{B22222}
\definecolor{TodoColour}         {rgb} {0.9,0.9,0.98}

\PassOptionsToPackage{full}{textcomp}

% Tikz
\usepackage{tikz}
\usepackage{forest}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{calc}
\usetikzlibrary{cd}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfplotstableset{col sep=comma}
\pgfplotsset{compat=1.3}

\usepackage{wrapfig}
\usepackage{cancel}

\usepackage{lineno}

\usepackage{cleveref}

% For some of the operators I define myself I use this package.
\usepackage{pict2e}

% This package lets us import code snippets into the document.
\usepackage{catchfilebetweentags}

% Packages with maths symbols.
\usepackage{mathtools}
\usepackage{turnstile}
\usepackage{stmaryrd}
\usepackage{latexsym}

\newtagform{nowidth}{\llap\bgroup(}{)\egroup}

% Allow for blackboard bold 0 and 1.
\DeclareMathAlphabet{\numberbb}{U}{bbold}{m}{n}

% Theorem environments
\theoremstyle{acmdefinition}
\newtheorem{definition}{Definition}


\newtheorem*{remark}{Remark}

% Maths fonts
\usepackage{mathrsfs}
\usepackage{bbm}
\let\Bbbk\relax % Need to avoid defining \Bbbk here, because it's defined in the
                % acmart template.

% Needed to typeset Agda's stuff (I think; I haven't actually tried removing it recently).
\usepackage[english]{babel}

% Handy package for on-the-fly resizing.
\usepackage{relsize}

% Does links and stuff.
\usepackage{hyperref}

\usepackage{cleveref}

% Citations
\usepackage{natbib}
\citestyle{acmauthoryear}

% Multiple figures
\usepackage{subcaption}
\usepackage{dblfloatfix}
\usepackage{multicol}
\setlength{\multicolsep}{6.0pt plus 2.0pt minus 1.5pt}% 50% of original values

\newcommand{\sameline}[1]{\sloppy{\mbox{#1}}}
\newcommand{\mathsameline}[1]{\sloppy{\({#1}\)}}

\newcommand{\twocolcode}[2]{\noindent%
\begin{minipage}[t][][b]{.49\linewidth}\vspace{-0.7\baselineskip}%
    #1%
  \end{minipage}%
  \begin{minipage}[t][][b]{.49\linewidth}\vspace{-0.7\baselineskip}%
    #2%
  \end{minipage}\\\noindent%
}

% Todo notes
\usepackage[backgroundcolor=TodoColour,textwidth=1.15cm]{todonotes}
\setlength{\marginparwidth}{1.22cm}
\newcommand{\mtodo}[1]{\todo[noinline,noline,size=tiny]{\tiny #1}}

% Arrow for hyperfunctions. Can't decide on best one.

% loop shape:
\newcommand{\hyparrow}{\looparrowright}
\newcommand{\hypmarrow}[1]{%
  \mathrel{%
    \makebox[0pt][c]{%
      \raisebox{-0.35em}{\(\;\;\scriptstyle#1\)}%
    }%
    \raisebox{0.15em}{\(\looparrowright\)}%
  }%
}
\tikzcdset{
  arrow style=tikz,
  diagrams={>={Straight Barb[scale=0.8]}},
}
\usepackage{amsmath}
\usepackage{amsthm}
\renewcommand{\qed}{\ensuremath{\hfill\blacksquare}}
\makeatletter
\newcommand{\eqnum}{\leavevmode\textup{\tagform@{\theequation}}}
\makeatother

\usepackage{algorithm2e}
\newenvironment{agdalisting}{}{}
\newenvironment{agdalisting*}{}{}
\newenvironment{marginagdalisting}[1]{}{}

\usepackage{environ}

% \NewEnviron{marginagdalisting}[1]{%
%   \refstepcounter{equation}
%   \marginpar{\centering%
%     \BODY\vspace{-0.8\baselineskip}\\%
%     Listing {\theequation}: #1%
%   }%
% }

\input{agda}

\PrerenderUnicode{íâĂŊ}



\keywords{Haskell, Agda, graph search, monad}

\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10003752.10003809.10003635.10010037</concept_id>
       <concept_desc>Theory of computation~Shortest paths</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003809.10011254.10011255</concept_id>
       <concept_desc>Theory of computation~Backtracking</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003790.10003792</concept_id>
       <concept_desc>Theory of computation~Proof theory</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003790.10003796</concept_id>
       <concept_desc>Theory of computation~Constructive mathematics</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003790.10011740</concept_id>
       <concept_desc>Theory of computation~Type theory</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003790.10002990</concept_id>
       <concept_desc>Theory of computation~Logic and verification</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10010124.10010131.10010132</concept_id>
       <concept_desc>Theory of computation~Algebraic semantics</concept_desc>
       <concept_significance>100</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011006.10011008.10011009.10011012</concept_id>
       <concept_desc>Software and its engineering~Functional languages</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011006.10011008.10011024.10011028</concept_id>
       <concept_desc>Software and its engineering~Data types and structures</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Theory of computation~Shortest paths}
\ccsdesc[500]{Theory of computation~Backtracking}
\ccsdesc[300]{Theory of computation~Proof theory}
\ccsdesc[300]{Theory of computation~Constructive mathematics}
\ccsdesc[300]{Theory of computation~Type theory}
\ccsdesc[300]{Theory of computation~Logic and verification}
\ccsdesc[100]{Theory of computation~Algebraic semantics}
\ccsdesc[500]{Software and its engineering~Functional languages}
\ccsdesc[300]{Software and its engineering~Data types and structures}
